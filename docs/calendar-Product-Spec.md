# 万年历工具 - Product Spec

## 一、产品定位

| 项目 | 内容 |
|------|------|
| 产品名称 | 万年历 |
| 产品类型 | 工具类 Web 应用 |
| 一句话定位 | 查看公历农历节假日信息的万年历工具 |
| 核心价值 | 公历农历对照 + 节假日标识 + 详细信息展示 |
| 目标用户 | 需要查看农历、节假日、宜忌信息的普通用户 |

## 二、目标用户画像

| 用户类型 | 使用场景 | 核心需求 |
|----------|----------|----------|
| 办公族 | 查看节假日安排、工作日 | 节假日标识、调休信息 |
| 传统用户 | 查看农历日期、宜忌 | 农历对照、宜忌信息 |
| 普通用户 | 日常查看日期 | 简洁清晰的日历展示 |

## 三、核心功能清单

### 3.1 必须功能 (MVP)

| 功能点 | 功能描述 | 优先级 |
|--------|----------|--------|
| 月历展示 | 显示当前月份的日历视图，支持切换月份 | P0 |
| 节假日标识 | 工作日、假日、节假日用不同颜色标识 | P0 |
| 日期选择 | 点击日期查看详细信息 | P0 |
| 详细信息展示 | 展示选中日期的所有接口返回信息 | P0 |
| 今日定位 | 一键跳转到今天 | P0 |

### 3.2 数据展示

| 数据字段 | 说明 | 展示方式 |
|----------|------|----------|
| date | 当前日期 | 顶部标题 |
| weekDay | 周几 | 星期显示 |
| yearTips | 天干地支 | 独立卡片 |
| type | 类型（工作日/假日/节假日） | 日历格子颜色 |
| detailsType | 详细类型 | 详情面板 |
| typeDes | 类型描述 | 日历格子/详情面板 |
| chineseZodiac | 属相 | 详情面板 |
| solarTerms | 节气 | 详情面板（如有） |
| lunarCalendar | 农历日期 | 日历格子/详情面板 |
| suit | 宜事项 | 详情面板 |
| dayOfYear | 一年中的第几天 | 详情面板 |
| weekOfYear | 一年中的第几周 | 详情面板 |
| constellation | 星座 | 详情面板 |
| indexWorkDayOfMonth | 月中第几个工作日 | 详情面板 |

## 四、用户流程

```
1. 用户进入页面
      ↓
2. 显示当前月份的日历
   - 工作日：蓝色背景
   - 假日：红色背景
   - 节假日：橙色背景
      ↓
3. 用户点击某个日期
      ↓
4. 右侧详情面板显示该日期的所有信息
      ↓
5. 用户可切换月份查看其他日期
      ↓
6. 用户可点击"今天"按钮快速定位
```

## 五、页面布局

### 5.1 整体布局

```
┌─────────────────────────────────────────────────────────────┐
│  顶部：万年历 Logo + "今天"按钮                              │
├─────────────────────────────────────────────────────────────┤
│  左侧（日历区）：          │  右侧（详情面板）：              │
│  ┌──────────────────┐    │  ┌────────────────────────┐    │
│  │  < 2025年1月 >   │    │  │  2025-01-15 详细信息   │    │
│  ├──────────────────┤    │  ├────────────────────────┤    │
│  │ 一 二 三 四 五 六 日 │    │  │ 星期三 | 工作日        │    │
│  ├──────────────────┤    │  ├────────────────────────┤    │
│  │  1  2  3  4  5  6  7 │    │  │ 农历：腊月十六         │    │
│  │  8  9 10 11 12 13 14 │    │  │ 干支：甲辰年           │    │
│  │ 15 16 17 18 19 20 21 │    │  │ 属相：龙 星座：摩羯座   │    │
│  │ 22 23 24 25 26 27 28 │    │  │ 节气：大寒             │    │
│  │ 29 30 31            │    │  │ 宜：嫁娶 祭祀...       │    │
│  └──────────────────┘    │  │ 第15天 第3周           │    │
│                          │  └────────────────────────┘    │
└─────────────────────────────────────────────────────────────┘
```

### 5.2 移动端布局

```
┌─────────────────────────┐
│  万年历      [今天]     │
├─────────────────────────┤
│  < 2025年1月 >          │
├─────────────────────────┤
│  日历网格               │
│  (上下滑动查看)         │
├─────────────────────────┤
│  选中日期详情面板       │
│  (可折叠)               │
└─────────────────────────┘
```

## 六、控件规范

### 6.1 日历格子

日历格子显示三行信息：
1. **第一行**：公历日期（大字）
2. **第二行**：农历日期
3. **第三行**：节日名称（仅节假日显示）

```
┌─────────┐
│   15    │  ← 公历日期
│ 腊月十六 │  ← 农历日期
│  春节   │  ← 节日（仅节假日显示）
└─────────┘
```

| 状态 | 样式 |
|------|------|
| 工作日 | 白色背景，深色文字 |
| 假日 | 红色淡背景，红色文字 |
| 节假日 | 橙色淡背景，橙色文字，显示节日名称 |
| 今天 | indigo-500 边框环 |
| 选中 | indigo-600 背景，白色文字 |
| 非本月 | 灰色文字 |

### 6.2 按钮

| 按钮 | 样式 |
|------|------|
| 今天 | 主色调 indigo-600，白色文字 |
| 月份切换 | 圆形图标按钮，hover 灰色背景 |

### 6.3 详情面板卡片

| 信息类型 | 背景色 |
|----------|--------|
| 农历 | orange-50 |
| 干支 | yellow-50 |
| 属相 | purple-50 |
| 星座 | blue-50 |
| 节气 | green-50 |
| 宜 | pink-50 |
| 统计 | gray-50 |

### 6.4 颜色规范

| 用途 | 颜色 |
|------|------|
| 主色 | #4f46e5 (indigo-600) |
| 工作日 | #3b82f6 (blue-500) |
| 假日 | #ef4444 (red-500) |
| 节假日 | #f97316 (orange-500) |
| 背景 | #f9fafb (gray-50) |
| 文字主色 | #111827 (gray-900) |
| 文字次色 | #6b7280 (gray-500) |

## 七、API 接口

### 7.1 获取月份数据

**接口地址**：`/api/calendar?date=YYYYMM`

**请求方式**：GET

**参数说明**：

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| date | string | 是 | 月份，格式：YYYYMM（如：202502） |
| ignoreHoliday | string | 否 | 是否忽略节假日，0-否，1-是，默认0 |

**返回示例**：

```json
{
    "code": 1,
    "msg": "数据返回成功",
    "data": [
        {
            "date": "2025-02-01",
            "weekDay": 6,
            "yearTips": "甲辰",
            "type": 0,
            "chineseZodiac": "龙",
            "typeDes": "工作日",
            "solarTerms": "大寒后",
            "avoid": "开仓.嫁娶.移徙.入宅",
            "lunarCalendar": "1-4",
            "suit": "祭祀.沐浴.祈福...",
            "dayOfYear": 32,
            "weekOfYear": 5,
            "constellation": "水瓶座",
            "indexWorkDayOfMonth": 1
        },
        ...
    ]
}
```

## 八、数据缓存

### 8.1 缓存策略

| 策略 | 说明 |
|------|------|
| 缓存位置 | localStorage |
| 缓存粒度 | 按月缓存 |
| 缓存有效期 | 30 天 |
| 缓存键名 | `calendar_month_cache` |

### 8.2 缓存流程

```
用户打开页面
    ↓
检查 localStorage 是否有该月缓存
    ↓
有缓存 → 直接使用缓存数据
无缓存 → 调用 API 获取数据 → 存入缓存
```

### 8.3 缓存数据结构

```json
{
  "2025-02": {
    "data": [...月份所有日期数据],
    "timestamp": 1708300800000
  },
  "2025-03": {
    "data": [...],
    "timestamp": 1710806400000
  }
}
```

## 九、非功能需求

### 9.1 性能要求

| 指标 | 要求 |
|------|------|
| 首屏加载 | < 2s |
| 月份切换 | < 500ms（已缓存则即时） |
| 日期选择 | 即时响应 |

### 9.2 兼容性

| 环境 | 要求 |
|------|------|
| Chrome | >= 90 |
| Firefox | >= 90 |
| Safari | >= 15 |
| Edge | >= 90 |
| 移动端 | iOS Safari >= 15, Chrome Android >= 90 |

## 九、上线计划

### Phase 1 - MVP

- [x] 月历展示
- [x] 月份切换
- [x] 节假日标识
- [x] 日期选择
- [x] 详细信息展示
- [x] 今日定位

### Phase 2 - 增强（可选）

- [ ] 年视图
- [ ] 节假日搜索
- [ ] 倒计时功能

## 十、总结

本产品定位为一款简洁实用的万年历工具。核心特点：

1. **清晰直观**：月历视图 + 农历日期 + 节假日标识
2. **信息丰富**：公历农历对照 + 干支属相 + 宜忌 + 节气
3. **响应式设计**：桌面端左右布局，移动端上下布局
4. **性能优化**：按月缓存 + localStorage 持久化
