(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,80789,e=>{"use strict";var l=e.i(68415);e.s(["Slider",()=>l.default])},32651,e=>{"use strict";var l=e.i(65408),t=e.i(17900),a=e.i(33086),s=e.i(59611),r=e.i(93997),d=e.i(80789),i=e.i(26012),n=e.i(24072),c=e.i(59990);let{TextArea:o}=a.Input,u=[{value:"AES",label:"AES"},{value:"DES",label:"DES"},{value:"RC4",label:"RC4"}],m=[{value:"ECB",label:"ECB (电码本)"},{value:"CBC",label:"CBC (密码块链接)"},{value:"CFB",label:"CFB (密码反馈)"},{value:"OFB",label:"OFB (输出反馈)"}],x={AES:[128,192,256],DES:[64],RC4:[40,128,256]};function h(){let[e,h]=(0,c.useState)(""),[p,b]=(0,c.useState)(""),[g,f]=(0,c.useState)("AES"),[y,j]=(0,c.useState)("CBC"),[v,C]=(0,c.useState)(256),[S,B]=(0,c.useState)(""),[N,E]=(0,c.useState)("encrypt");return(0,l.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"文本加密解密"}),(0,l.jsx)("p",{className:"text-gray-600 mt-1",children:"对称加密解密文本"})]}),(0,l.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,l.jsx)(t.Button,{type:"encrypt"===N?"primary":"default",onClick:()=>E("encrypt"),children:"加密"}),(0,l.jsx)(t.Button,{type:"decrypt"===N?"primary":"default",onClick:()=>E("decrypt"),children:"解密"})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4 mb-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"algorithm-select",className:"font-medium text-gray-700 block mb-2",children:"加密算法"}),(0,l.jsx)(r.Select,{id:"algorithm-select",value:g,onChange:e=>{f(e),C(x[e][0])},options:u,className:"w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"mode-select",className:"font-medium text-gray-700 block mb-2",children:"加密模式"}),(0,l.jsx)(r.Select,{id:"mode-select",value:y,onChange:j,options:m,className:"w-full"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"key-length-slider",className:"font-medium text-gray-700 block mb-2",children:["密钥长度: ",v," 位"]}),(0,l.jsx)(d.Slider,{id:"key-length-slider",min:x[g][0],max:x[g][x[g].length-1],value:v,onChange:C,marks:x[g].reduce((e,l)=>({...e,[l]:`${l}`}),{})})]})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{htmlFor:"key-input",className:"font-medium text-gray-700 block mb-2",children:"密钥"}),(0,l.jsx)(a.Input.Password,{id:"key-input",value:p,onChange:e=>b(e.target.value),placeholder:"请输入密钥..."})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("label",{htmlFor:"input-textarea",className:"font-medium text-gray-700 block mb-2",children:"encrypt"===N?"明文":"密文"}),(0,l.jsx)(o,{id:"input-textarea",value:e,onChange:e=>h(e.target.value),placeholder:"encrypt"===N?"请输入明文...":"请输入密文...",className:"font-mono text-sm",rows:6})]}),(0,l.jsx)(t.Button,{type:"primary",onClick:()=>{try{if(!e||!p)return void s.message.error("请输入内容和密钥");let l="encrypt"===N?function(e,l,t,a,s){let r=n.default.enc.Utf8.parse(l.padEnd(s/8,"0").slice(0,s/8));if("ECB"===a)return n.default[t].encrypt(e,r).toString();let d=n.default.lib.WordArray.random(8),i=n.default[t].encrypt(e,r,{mode:n.default[a],iv:d,padding:n.default.pad.Pkcs7});return`${d.toString()}:${i.toString()}`}(e,p,g,y,v):function(e,l,t,a,s){let r=n.default.enc.Utf8.parse(l.padEnd(s/8,"0").slice(0,s/8));if("ECB"===a)return n.default[t].decrypt(e,r).toString(n.default.enc.Utf8);let d=e.split(":");if(2!==d.length)throw Error("无效的密文格式");let i=n.default.enc.Hex.parse(d[0]),c=d[1];return n.default[t].decrypt(c,r,{mode:n.default[a],iv:i,padding:n.default.pad.Pkcs7}).toString(n.default.enc.Utf8)}(e,p,g,y,v);B(l),s.message.success("encrypt"===N?"加密成功":"解密成功")}catch(e){s.message.error(e instanceof Error?e.message:"处理失败")}},children:"encrypt"===N?"加密":"解密"})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 p-4 mb-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsx)("label",{htmlFor:"output-textarea",className:"font-medium text-gray-700",children:"encrypt"===N?"密文":"明文"}),(0,l.jsx)(t.Button,{onClick:()=>{S&&((0,i.default)(S),s.message.success("复制成功"))},disabled:!S,size:"small",children:"复制"})]}),(0,l.jsx)(o,{id:"output-textarea",value:S,readOnly:!0,className:"font-mono text-sm bg-gray-50",rows:6,placeholder:"输出结果..."})]}),(0,l.jsxs)("div",{className:"bg-blue-50 rounded-lg border border-blue-200 p-4",children:[(0,l.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"使用提示"}),(0,l.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,l.jsx)("li",{children:"• AES 支持 128/192/256 位密钥，DES 仅支持 64 位"}),(0,l.jsx)("li",{children:"• ECB 模式不需要 IV，但安全性较低；CBC/CFB/OFB 需要 IV"}),(0,l.jsx)("li",{children:"• 加密后的密文格式为: IV:密文 (CBC/CFB/OFB 模式)"}),(0,l.jsx)("li",{children:"• 解密时需使用与加密相同的算法、模式和密钥长度"})]})]})]})}e.s(["default",()=>h])}]);